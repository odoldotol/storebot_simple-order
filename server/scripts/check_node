SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
PACKAGE_JSON="$SCRIPT_DIR/../package.json"

if ! command -v jq >/dev/null 2>&1; then
  echo "jq is not installed. Please install jq to continue."
  exit 1
fi

TARGET_VERSION=$(jq -r '.engines.node' "$PACKAGE_JSON" 2>/dev/null)
CURRENT_VERSION=$(node -v 2>/dev/null)

if [ $? -ne 0 ]; then
  echo "Node.js is not installed. Please install Node.js."
  exit 1
fi

CURRENT_VERSION=${CURRENT_VERSION#v}

if [ "$CURRENT_VERSION" = "$TARGET_VERSION" ]; then
  echo "Node.js version is $TARGET_VERSION."
  exit 0
else
  echo "Node.js version is not $TARGET_VERSION. Current version: $CURRENT_VERSION"
  exit 1
fi